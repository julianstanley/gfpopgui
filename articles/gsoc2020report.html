<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GSOC 2020 Report • gfpopgui</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GSOC 2020 Report">
<meta property="og:description" content="gfpopgui">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gfpopgui</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/tutorialvideos.html">Tutorial Videos</a>
</li>
<li>
  <a href="../articles/gsoc2020report.html">GSOC Report</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/julianstanley/gfpopgui/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gsoc2020report_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>GSOC 2020 Report</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/julianstanley/gfpopgui/blob/HEAD/vignettes/gsoc2020report.Rmd" class="external-link"><code>vignettes/gsoc2020report.Rmd</code></a></small>
      <div class="hidden name"><code>gsoc2020report.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="tldr">TL;DR<a class="anchor" aria-label="anchor" href="#tldr"></a>
</h2>
<p>I built a stable web application for creating directed graphs to constrain the <code>gfpop</code> changepoint-detection algorithm. <a href="https://github.com/julianstanley/gfpopgui/commits/master?user=julianstanley" class="external-link">Commit history</a>.</p>
<p>Users can run an entire analysis in the app, or they can construct a graph and export it as R code.</p>
<p>The application is an R package <a href="https://github.com/julianstanley/gfpopgui/" class="external-link">available here</a>. It is hosted through shinyapps.io <a href="https://julianstanley.shinyapps.io/gfpopgui/" class="external-link">at this address</a>. More documentation is <a href="https://julianstanley.github.io/gfpopgui/" class="external-link">available here</a>.</p>
<p>The application is well-tested, but still needs more integration tests. Rewriting components in JavaScript would increase efficiency. Some features, such as analysis of <code>gfpop</code> accuracy, are not yet implemented. I hope to continue patching this project after the GSOC period.</p>
</div>
<div class="section level2">
<h2 id="introduction-and-contribution">Introduction and Contribution<a class="anchor" aria-label="anchor" href="#introduction-and-contribution"></a>
</h2>
<p>Where do sudden changes in data occur? While changepoints may be apparent by eye, accurately identifying changepoints algorithmically without any prior information is very difficult.</p>
<p>Luckily, in scenarios where a researcher wants to detect changepoints, they often have some prior information about changepoint patterns. For example, imagine that you are modeling electricity flow through a light switch. You should expect electricity flow to suddenly increase when the switch is “on”, and suddenly decrease when the switch is “off”. In this case, you expect your changepoints (the times at which the switch is turned “on” or “off”) to alternate between “up” and “down” states with higher and lower average amounts of electricity, respectively.</p>
<p>In 2018, Toby Hocking, Guillem Rigaill, and others introduced an efficient algorithm to detect changepoints by incorporating prior information about changepoint patterns. They named the algorithm “Generalized Functional Pruning Optimal Partitioning”, or GFPOP, and developed an associated R package, <code>gfpop</code>.</p>
<p><code>gfpop</code> asks users to encode prior information about changepoint patterns as a directed graph. In the light switch example above, the directed graph would be an “up” and a “down” node and two edges, one going from “up” to “down”, and another going from “down” to “up”.</p>
<p>The <code>gfpop</code> package provides <code>Edge</code> and <code>Node</code> classes so that users can build directed graphs to constrain the GFPOP algorithm. However, it would be more intuitive if users could build graphs visually by, for example, clicking and dragging between two nodes to create a connecting edge. It would also be helpful if it were easy to visualize how nodes and edges in the graph correspond to changepoint locations in the data.</p>
<p>This summer, Toby Hocking and Guillem Rigaill mentored me as I created a web application, called <code>gfpopgui</code> where users can interactively build graphs and see how modifying their graphs impacts the results of the <code>gfpop</code> package.</p>
<p>You can find the application <a href="https://julianstanley.shinyapps.io/gfpopgui/" class="external-link">online here</a>, or you can run a local copy with <code>devtools::install_github("julianstanley/gfpopgui"); gfpopgui::run_app()</code>.</p>
</div>
<div class="section level2">
<h2 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a>
</h2>
<p>The application is built with R Shiny, along with a little bit of JavaScript.</p>
<p>The application has four pages. The “Home” page contains some instructions on how to get started, and is also where users can upload their data (including already-completed constraint graphs or .Rdata files containing whole analyses), or generate some sample data.</p>
<p>The “Analysis” page is where most of the application lives. Here, users can interactively build a constraint graph. They have the option to build the graph by (i) clicking directly on the nodes or edges, (ii) clicking on cells within a data.table, or (iii) inputting parameters in text boxes and drop-down menus and clicking buttons to add, edit, or delete nodes and edges. Then, users can press a button to run <code>gfpop</code> with their custom data and then view the outputs.</p>
<p>Importantly, the “Analysis” page includes cross-talk between the custom constraint graph and the plot that shows the results of <code>gfpop</code>. When a user hovers over a changepoints in their data, the corresponding graph node is highlighted, and vice-versa.</p>
<p>In addition, users may save full clones of previous data on the “Analysis” page, allowing them to experiment with new graph structures without fear of losing a previous, stable version.</p>
<p>Since the application does not have a user system, <code>gfpopgui</code> users should export all of their analysis before exiting the application. To do so, they can navigate to the “Sharing” page, which includes a quick preview of the current analysis, as well as buttons to download different aspects of the analysis.</p>
<p>Finally, the “Help” page includes some additional documentation and links.</p>
<div class="section level3">
<h3 id="shiny-and-javascript-logistics">Shiny and Javascript Logistics<a class="anchor" aria-label="anchor" href="#shiny-and-javascript-logistics"></a>
</h3>
<p>Most of the application relies on the Shiny framework. There are different ways to format a Shiny application, and I choose to use the guidelines provided by the <code>golem</code> package. That is, the application is:</p>
<ol style="list-style-type: lower-roman">
<li>contained within an R package,</li>
<li>broken into modules</li>
<li>tested via <code>testthat</code>, and</li>
<li>documented with <code>roxygen</code>, like the package it is.</li>
</ol>
<p>The application is generally divided within a <code><a href="https://rdrr.io/pkg/shiny/man/navbarPage.html" class="external-link">shiny::navbarPage()</a></code>. Then, each page is separated into a different shiny module.</p>
<p>In the future, the application might be improved if I can separate the application into more modules. While the one-module-per-page approach is more advantageous than not using modules at all, it doesn’t conform with the spirit of modules, that is, creating reusable parts with which a broad application can be built.</p>
</div>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h3>
<p><code>gfpopgui</code> relies on a lot of dependencies. Most notably, it heavily relies on <code>plotly</code> and <code>visNetwork</code> to create interactive plots of the data/changepoints and the constraint graph, respectively. And each of these two packages rely on various other packages in turn. While <code>plotly</code> and <code>visNetwork</code> are both quite stable, <code>gfpopgui</code> could be improved by reducing the number of dependencies.</p>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h3>
<p>A lot of my time this summer has been dedicated testing. Namely, there are four main ways to test shiny applications:</p>
<ol style="list-style-type: lower-roman">
<li>unit testing</li>
<li>integration testing via <code>testServer()</code>
</li>
<li>integration testing via <code>shinytest</code>
</li>
<li>integration testing via <code>RSelenium</code> and SauceLabs.</li>
</ol>
<p>In my opinion, this is also the order of the difficulty of implementing each testing framework–unit tests are generally easy to write, fast, and transparent, whereas integration tests that involve a headless browser, such as shinytest and RSelenium, are much more difficult to implement.</p>
<p>All four of these methods rely on <code>testthat</code> for expectations.</p>
<p>My first approach to testing was to functionalize as much as possible, and use unit tests. This approach was amenable to most of the functionality in <code>gfpopgui</code> and is very transparent. In the <code>golem</code> framework, functions are defined in separate files, prefaced with <code>fct_</code>. Each of the <code>fct</code> files have unit tests in an associated <code>tests/testthat/test-*.R</code> file. For example, the unit tests for <code>R/fct-graph-helpers</code> can be found at <code>tests/testthat/test-graph-helpers.R</code>.</p>
<p>Then, I was left with functionality that requires reactivity, and therefore cannot be tested with unit tests. For those features, I used <code>testServer()</code>, a new method in the <code>shiny</code> package that allows to users to direct test server modules without the use of a headless browser. Those tests can be found in <code>test-integration-testServer.R</code>.</p>
<p>However, <code>testServer()</code> cannot test any features that require javascript. For that, many users use the <code>shinytest</code> package. However, I had some trouble implementing <code>shinytest</code> tests–I could only run these tests locally. One future direction of the project could be better defining and troubleshooting problems implementing <code>shinytest</code>.</p>
<p><code>RSelenium</code> is also an option for testing features that require javascript. It required a lot of troubleshooting to set up, and I wrote a few <code>gfpopgui</code> tests through that platform, but I regret that I could not write more. I have written down what I learned about the setup <a href="https://julianstanley.github.io/gfpopgui/articles/rselenium_lessons.html" class="external-link">here</a>.</p>
<p>In total, I tracked coverage with CodeCov.io and the current commit has a code coverage of around 92%. For more information, see <a href="https://codecov.io/gh/julianstanley/gfpopgui/" class="external-link">the project’s CodeCov page</a>.</p>
</div>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h3>
<p>Throughout this project, I kept approximately-weekly, blog-style logs of my progress. You can find those articles <a href="https://julianstanley.github.io/gfpopgui/articles/timeline.html" class="external-link">here</a>.</p>
<p>To better explain how the application itself works, I created a series of tutorial videos. Those are hosted on YouTube and you can find them <a href="https://julianstanley.github.io/gfpopgui/articles/tutorialvideos.html" class="external-link">here</a>.</p>
</div>
<div class="section level3">
<h3 id="continuous-integration">Continuous Integration<a class="anchor" aria-label="anchor" href="#continuous-integration"></a>
</h3>
<p>When the master branch is updated in the <code>gfpopgui</code> repository, there are four continuous integration actions triggered:</p>
<ol style="list-style-type: decimal">
<li>Travis CI: CMD Check. A CRAN CMD check is performed by Travis.</li>
<li>Travis CI: shinyapps.io deploy. Travis automatically deploys all changes to the shinyapps.io server.</li>
<li>GitHub Actions: Cross-platform CMD Check. GitHub actions performs a CRAN CMD check on macOS-latest, windows-latest, ubuntu-16.04 devel, and ubuntu-16.04 release.</li>
<li>GitHub Actions: pkgdown render. GitHub actions runs <code><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">pkgdown::build_site()</a></code> to update the documentation website.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="future-directions">Future directions<a class="anchor" aria-label="anchor" href="#future-directions"></a>
</h2>
<p>While I think the gfpop GUI is relatively stable right now, I think there is a lot of room for improvement. Namely,</p>
<ol style="list-style-type: decimal">
<li><p>Features. Some additional features would make the application more useful. For example, (a) changepoints themselves, rather than just changeregions, should cause graph <em>edges</em> to be highlighted; (b) users should be able to view quantitatively how much the predicted changepoints differ from their expectations/the ground truth; and (c) a user management system, where individual users can save all of their data to a database, would reduce the need for saving and loading.</p></li>
<li><p>Efficiency. Different components of the application could be optimized. For example, cross-talk between the plotly visualization and the constraint graph should be done client-side, without Shiny.</p></li>
<li><p>Testing. The application needs more integration testing. For example, right now download handlers are not tested.</p></li>
</ol>
<p>In the previous sections, I discussed some particular future directions. Additionally, reference the <a href="https://github.com/julianstanley/gfpopgui/issues" class="external-link">issues page</a> for more current information.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julian Stanley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
